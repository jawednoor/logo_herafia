# دليل إعداد رفع الملفات إلى Google Drive

## نظرة عامة
تم تحديث نموذج استبيان تصميم الشعار ليدعم إنشاء مجلدات تلقائية في Google Drive لكل مستخدم ورفع الشعارات مباشرة.

## آلية العمل

### 1. تدفق العملية
1. المستخدم يملأ النموذج ويدخل اسمه الرباعي
2. عند الضغط على "إرسال الاستبيان":
   - يتم إنشاء مجلد جديد باسم المستخدم + التاريخ
   - يظهر رابط المجلد للمستخدم
   - يتم حفظ البيانات في Google Sheets مع رابط المجلد
3. المستخدم يرفع الشعارات الثلاثة في المجلد المنشأ

### 2. إعداد Google Apps Script

#### خطوة 1: إنشاء مشروع جديد
1. اذهب إلى [script.google.com](https://script.google.com)
2. انقر "مشروع جديد"
3. انسخ محتوى ملف `google-apps-script-updated.js`

#### خطوة 2: تفعيل APIs المطلوبة (شرح مفصل)

**الطريقة الجديدة (2024-2025):**

1. **في محرر Google Apps Script:**
   - ابحث عن أيقونة ⚙️ (الإعدادات) في القائمة اليسرى
   - أو ابحث عن "Services" في القائمة الجانبية

2. **إضافة الخدمات:**
   - انقر على زر "+ Add a service" 
   - ستظهر قائمة بجميع الخدمات المتاحة

3. **اختر الخدمات التالية واحدة تلو الأخرى:**
   
   **أ) Google Drive API:**
   - ابحث عن "Drive" في قائمة البحث
   - انقر على "Google Drive API"
   - اضغط "Add"
   
   **ب) Google Sheets API:**
   - ابحث عن "Sheets" 
   - انقر على "Google Sheets API"
   - اضغط "Add"
   
   **ج) Gmail API (اختياري للإشعارات):**
   - ابحث عن "Gmail"
   - انقر على "Gmail API" 
   - اضغط "Add"

4. **التحقق من التفعيل:**
   - بعد إضافة كل خدمة، ستظهر في قائمة "Services"
   - تأكد من وجود الثلاث خدمات في القائمة

**ملاحظة مهمة:** 
إذا لم تجد قسم "Services"، استخدم الطريقة البديلة:
- اذهب إلى Google Cloud Console
- فعّل APIs من هناك
- أو استخدم الكود بدون تفعيل مسبق (سيطلب الإذن تلقائياً)

**الطريقة الأسهل للمبتدئين:**
ببساطة، انسخ الكود والصق في Google Apps Script. عند أول تشغيل:
1. سيطلب منك Google إذونات للوصول إلى Drive و Sheets
2. اضغط "Allow" أو "السماح" لجميع الطلبات
3. ستعمل الخدمات تلقائياً بدون إعداد إضافي

#### خطوة 3: تحديث الإعدادات
في الملف المنسوخ، عدّل المتغيرات التالية:

```javascript
const CONFIG = {
  SHEET_ID: 'معرف_جوجل_شيت_الخاص_بك',
  MAIN_FOLDER_ID: '1R_0cXX-I-VWrDvFFJXu9Y2TWOk5q1zS_',
  EMAIL: 'بريدك_الإلكتروني@gmail.com'
};
```

#### خطوة 4: نشر كـ Web App
1. انقر "نشر" ← "نشر جديد"
2. اختر:
   - النوع: "تطبيق ويب"
   - التشغيل كـ: "أنا"
   - الوصول: "أي شخص"
3. انسخ رابط Web App

#### خطوة 5: تحديث رابط JavaScript
في ملف `script.js`، ابحث عن:
```javascript
const GOOGLE_SCRIPT_URL = 'رابط_Web_App_الجديد';
```
واستبدله برابط Web App المنسوخ.

### 3. إعداد Google Drive

#### إعدادات المجلد الرئيسي
1. المجلد الرئيسي: `https://drive.google.com/drive/folders/1R_0cXX-I-VWrDvFFJXu9Y2TWOk5q1zS_`
2. تأكد من أن المجلد قابل للكتابة من قبل السكريبت
3. سيتم إنشاء مجلدات فرعية تلقائياً

#### صيغة أسماء المجلدات
```
اسم_المستخدم_الرباعي - التاريخ
مثال: أحمد محمد علي السعد - 2025-10-08
```

### 4. إعداد Google Sheets

#### العمود P (رابط المجلد)
- يتم حفظ رابط مجلد كل مستخدم في العمود P
- يمكن الوصول المباشر للمجلد من الجدول

#### العواميد المطلوبة
تأكد من وجود العواميد التالية في الصف الأول:
```
Timestamp | FullName | PhoneNumber | BrandName | HasExistingLogo | 
ExistingLogoChanges | BusinessType | BusinessDescription | TargetAudience |
LogoType | PrimaryColors | SecondaryColors | AvoidColors | 
LogoStyle | LogoUsage | AdditionalNotes | UserFolderUrl
```

### 5. تجربة النظام

#### اختبار إنشاء المجلد
1. في Google Apps Script، اذهب إلى دالة `testFunction`
2. اضغط "تشغيل"
3. تحقق من إنشاء مجلد اختبار

#### اختبار النموذج الكامل
1. املأ النموذج بالبيانات الاختبارية
2. تأكد من ظهور رابط المجلد
3. تحقق من حفظ البيانات في Sheets

### 6. استكشاف الأخطاء

#### مشاكل شائعة وحلولها

**خطأ: "فشل في إنشاء المجلد"**
- تحقق من صحة معرف المجلد الرئيسي
- تأكد من تفعيل Google Drive API

**خطأ: "غير مصرح"**
- تأكد من إعطاء الصلاحيات المطلوبة للسكريبت
- أعد نشر Web App بصلاحيات جديدة

**لا يظهر رابط المجلد**
- تحقق من وجود الاسم الرباعي
- تأكد من رد السكريبت بـ userFolderUrl

### 7. الصيانة والمراقبة

#### مراقبة الأداء
- راجع سجلات Google Apps Script للأخطاء
- تحقق من مساحة Google Drive المتبقية

#### النسخ الاحتياطي
- اعمل نسخة احتياطية من السكريبت شهرياً
- راقب حالة المجلد الرئيسي

### 8. ميزات إضافية متاحة

#### إشعارات البريد الإلكتروني
- يتم إرسال إشعار لكل استبيان جديد
- يحتوي على رابط المجلد مباشرة

#### التنظيم التلقائي
- المجلدات مرتبة بالتاريخ
- أسماء فريدة لتجنب التكرار

---

## معلومات تقنية

### متطلبات النظام
- Google Apps Script
- Google Drive API
- Google Sheets API
- Gmail API (للإشعارات)

### الحدود والقيود
- حد أقصى 6 دقائق لتنفيذ السكريبت
- حد أقصى 20MB للملف الواحد في النموذج
- 15GB مساحة مجانية في Google Drive

### الأمان
- المجلدات قابلة للعرض فقط (View Only)
- روابط محمية بـ Google Drive
- بيانات مشفرة أثناء النقل

---

للدعم التقني، راجع سجلات Google Apps Script أو تواصل مع المطور.